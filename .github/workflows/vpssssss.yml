name: Ubuntu VPS via Serveo (Stable)

on: [workflow_dispatch]

jobs:
  ubuntu-vps:
    runs-on: ubuntu-latest

    steps:
      - name: โฌ ุฅุนุฏุงุฏ SSH ูุชุบููุฑ ุงูุจุงุณูุฑุฏ
        run: |
          echo "๐ฆ ุชุซุจูุช SSH ููุชุญ ุงูุงุชุตุงู..."
          sudo apt update
          sudo apt install -y openssh-server curl
          sudo systemctl enable ssh
          sudo systemctl start ssh
          
          echo "๐ ุถุจุท ุจุงุณูุฑุฏ root..."
          echo "root:Vbnb123@" | sudo chpasswd
          
          echo "๐๏ธ ุชูุนูู ุงูุฏุฎูู ูู root"
          sudo sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config
          sudo sed -i 's/#PasswordAuthentication yes/PasswordAuthentication yes/' /etc/ssh/sshd_config
          sudo systemctl restart ssh

      - name: ๐ ูุชุญ ุงุชุตุงู Serveo ุชููุงุฆู
        run: |
          echo "๐ ุจุฏุก tunneling ูุน ุชุฎุตูุต terminal..."
          ssh -tt -o StrictHostKeyChecking=no -R 0:localhost:22 serveo.net > serveo.log 2>&1 &
          sleep 15

          echo "๐ก ุงุณุชุฎุฑุงุฌ ุฑุงุจุท ุงูุงุชุตุงู..."
          tunnel_url=$(grep -o 'Forwarding.*serveo.net:[0-9]*' serveo.log | awk '{print $3}')
          
          if [ -z "$tunnel_url" ]; then
            echo "โ ูุดู ุงุณุชุฎุฑุงุฌ ุงูุฑุงุจุท. ุญุงูู ุชุดุบูู ุงูู workflow ุชุงูู."
            exit 1
          fi

          echo "โ ุชู ุชุดุบูู VPS ุจูุฌุงุญ!"
          echo
          echo "================= ุจูุงูุงุช ุงูุงุชุตุงู ================="
          echo "๐ SSH Command:"
          echo "ssh root@$tunnel_url"
          echo
          echo "๐งโ๐ป Username: root"
          echo "๐ Password: Vbnb123@"
          echo "==================================================="
          echo "๐ ุงูุฌูุณุฉ ูุชุดุชุบู ููุฏุฉ 6 ุณุงุนุงุช ุฃู ูุญุฏ ูุง ุชููู ุงูู workflow"
